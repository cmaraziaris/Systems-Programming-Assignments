
Προγραμματισμός Συστήματος - 3η εργασία - Εαρινό Εξάμηνο 2020

Γενικά: Έχουν υλοποιηθεί όλα τα ζητούμενα της άσκησης σε C και σε όλα τα αρχεία υπάρχει εκτενής σχολιασμός.


Δομή αρχικού καταλόγου:
-----------------------
> Makefile
> README.txt
> src/ : Ο πηγαίος κώδικας της εργασίας
> sample_data/ : Περιέχει αρχεία με queries και έναν κατάλογο με εγγραφές ασθενών
(εντελώς προαιρετική η χρήση τους, μπορείτε να δώσετε τα δικά σας δοκιμαστικά αρχεία/καταλόγους).


***************************
*                         *
*    Compile : make -s    *
*                         *
***************************


Σχετικά με την δικτυακή επικοινωνία
------------------------------------

Υποστηρίζεται και προτείνεται η ταυτόχρονη λειτουργία server/client/master/workers σε διαφορετικά μηχανήματα της σχολής.
Το πρωτόκολλο επικοινωνίας πάνω από το δίκτυο είναι επηρεασμένο από το γνωστό πρωτόκολλο TCP/IP.
Προσoμοιώνονται τα μηνύματα FIN και ACK με τους κωδικούς "END_OF_TRANSMISSION" και "RESPONSE_RECEIVED" (αρχείο src/communication/ipc.h).


Συγχρονισμός του stdout από threads
------------------------------------

Ο συγχρονισμός του stdout επιτυγχάνεται μέσω της συνάρτησης flockfile(), που κλειδώνει το stdout σε ένα thread μέχρι να κληθεί η funlockfile().
Η χρήση της γίνεται μόνο όταν ένα thread πρέπει να εκτελέσει πολλές διαδοχικές κλήσεις στην printf().
Διαφορετικά, δεν χρησιμοποιείται η flockfile(), διότι κάθε μεμονωμένη κλήση της συνάρτησης printf() είναι thread-safe.


Αποδέσμευση μνήμης στα εκτελέσιμα αρχεία
-----------------------------------------

Ο client αποδεσμεύει όλη τη μνήμη που χρειάστηκε σε περίπτωση ομαλού τερματισμού.
Ο master αποδεσμεύει όλη τη μνήμη που χρειάστηκε με τη χρήση των σημάτων SIGINT/SIGQUIT.
Kάθε worker, αλλά και ο server, αποδεσμεύει όλη τη μνήμη που χρειάστηκε με τη χρήση του σήματος SIGINT.
Ωστόσο, τόσο ο worker όσο και ο server πρέπει να είναι αδρανείς όταν σταλεί το σήμα SIGINT, δηλαδή δεν πρέπει να βρίσκονται στη μέση της επεξεργασίας αιτημάτων, προκειμένου να αποδεσμευτεί ομαλά όλη η δεσμευμένη μνήμη.


Παραδοχές / Σημειώσεις
-----------------------

1) Κάθε client έχει X threads, τα οποία συγχρονίζονται και προωθούν κάθε φορά (το πολύ) Χ αιτήματα στον server από το αρχείο με τα queries.
Για παράδειγμα, αν το αρχείο έχει 90 queries και ο client έχει 20 threads, τότε ο client θα στείλει 20 - 20 - 20 - 20 - 10 αιτήματα, περιμένοντας στο ενδιάμεσο να συγχρονιστούν τα threads του ώστε να ξεκινήσουν πάλι όλα μαζί.

2) Οι workers εκτυπώνουν το process ID τους όταν είναι έτοιμοι να λάβουν αιτήματα, προκειμένου να μπορεί να τους σταλεί εύκολα κάποιο σήμα από τον χρήστη (και να ελεγχθεί το SIGCHLD).

3) Τα port numbers στα sockets (εκτός από αυτά που δίνει ο χρήστης στη γραμμή εντολών) ανατίθονται κάθε φορά από το λειτουργικό (δηλ. δίνεται port 0 κατά τη δημιουργία τους).
